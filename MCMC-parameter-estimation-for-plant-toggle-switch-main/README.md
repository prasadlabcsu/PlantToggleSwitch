# MCMC-parameter-estimation-for-plant-toggle-switch
MCMC parameter estimation of plant toggle switch with inputs of dynamic whole plant luminescence measurement 
Built on reported ordinary differential equation (ODE) models (1) ( Equation S1), our ODE model also consists of 1) two Hill functions describing the input-output characteristics of the two mutually repressible promoters and 2) first-order dynamics for repressor degradation, Additional terms were introduced to better describe the behaviors of the toggle switches in plants, and address the increase in the complexity of the system. 1) binary terms (k_DEX and k_OHT) for the absence or presence of inducer; 2) constitutive expression terms (α_DEX and α_OHT) for the strengths of the inducible promoters; 3) α_x and α_y for the basal expression levels of the repressible promoters. 

Equation S1 

dX/dT=k_OHT α_OHT+α_x+b_x/(1+(Y/K_x )^(n_x ) )-d_x X	

dY/dT=k_DEX α_DEX+α_y+b_y/(1+(X/K_y )^(n_y ) )-d_y Y	

To test the bistability, we devised a novel method to fit the model (Equation 1) to the whole-plant luminescence data. We assumed the degradation constants of the two repressors are same to simplify the fitting. We defined a likelihood function as the negative logarithm of the squared distances between the experimental data and numerical solutions of Equation S1, which is a weighted average of all seven different treatments in genetically identical plants with the same toggle circuit. We used a statistical approach, the Markov Chain Monte Carlo (MCMC) method, a class of algorithms for systematic random sampling of probabilities, to estimate the maximum-likelihood parameter values of the toggle switch tested in plants. Each MCMC run consists of: 1) parameter initialization as a uniformly distributed random variable inside the parameter space (e.g., Hill coefficients no greater than 6). 2) At each iteration, a Gaussian displacement was proposed for each parameter sequentially and the log likelihood function evaluated for every new set of parameter values. The proposed parameter set was accepted according to typical Metropolis criteria, where a proposed parameter value was either always accepted if it increased the log likelihood, or accepted with a probability if it decreased the log likelihood (2). 3) The MCMC run was terminated if either the maximum number of iterations (10,000) was reached, or a successful run with convergence achieved, defined as no significant change in log likelihood for more than 500 iterations. Only parameters obtained by as a successful run were stored and retained for further analysis. The goodness of fit as measured by the value of the log likelihood function was bimodal in most cases, with a distinct population that clustered with the optimal fit. These were deemed the best parameter sets and were analyzed separately. 
References
1.	T. S. Gardner, C. R. Cantor, J. J. Collins, Construction of a genetic toggle switch in Escherichia coli. Nature 403, 339-342 (2000).
2.	W. Press, S. Teukolsky, W. Vetterling, B. Flannery (2007) Numerical recipes: the art of scientific computing, 3rd Edition.
